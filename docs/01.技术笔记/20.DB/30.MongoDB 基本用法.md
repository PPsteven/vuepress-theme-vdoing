---
title: MongoDB åŸºæœ¬ç”¨æ³•
date: 2021-07-08 01:29:23
permalink: /pages/6fdfeb/
categories: 
  - åç«¯
  - DB
tags: 
  - null
---

è®°å¾—æœ€æ—©ä½¿ç”¨çš„æ•°æ®åº“å°±æ˜¯MongoDBï¼Œå½“æ—¶æ‡µæ‡‚æ— çŸ¥ï¼Œå°±çŸ¥é“éœ€è¦ç”¨ä¸€ä¸ªæ•°æ®åº“å»å‚¨å­˜æ•°æ®ï¼Œä¹Ÿåˆ†ä¸æ¸…SQL å’Œ NoSQLã€‚ä¸è¿‡MongoDBä»¥å®ƒçš„æ–¹ä¾¿å¿«æ·å¸å¼•äº†æˆ‘ï¼Œä»¥è‡³äºåæ¥æ¯æ¬¡ç”¨MySQLçš„æ—¶å€™ï¼Œè¿˜å¥‡æ€ªä¸ºå•¥æ¯æ¬¡éƒ½éœ€è¦DDLå®šä¹‰ç»“æ„ï¼Œå¥½éº»çƒ¦ã€‚

P.S. è¿˜è®°å¾—å­¦å®ŒMongoDBçš„é‚£ä¸ªæ™šä¸Šï¼Œé»„æ˜ğŸŒ†è¿˜æ˜¯è›®å¥½çœ‹çš„æ ·å­

<!--more-->

## å®‰è£…æ•™ç¨‹

## åŸºç¡€å‘½ä»¤

> å‚è€ƒæ•™ç¨‹æ¨èï¼š[CRUD Guides: Create, Read, Update, and Delete Data](https://docs.mongodb.com/guides/server/insert/)

## æ•°æ®åº“&é›†åˆ

```
use test # åˆ‡æ¢æ•°æ®åº“
show dbs # æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“
show collections # æ˜¾ç¤ºæ‰€æœ‰collections

db.dropDatabase(test) # åˆ é™¤æ•°æ®åº“ test
db.createCollection(inventory) # åˆ›å»ºé›†åˆ inventory
db.inventory.drop() # åˆ é™¤é›†åˆ inventory


mongo mongodb://$[hostlist]/$[database]?authSource=$[authSource] --username $[username] # è¿æ¥æ•°æ®åº“
```

### æŸ¥è¯¢æ–‡æ¡£

```
# æŸ¥è¯¢å…¨é‡æ•°æ®
db.inventory.find({}) 

# å¸¦Queryçš„æŸ¥è¯¢
db.inventory.find( { size: { h: 14, w: 21, uom: "cm" } } ) 
db.inventory.find( { "size.uom": "in" } ) # ä½¿ç”¨ dot notation

# å¸¦æ¯”è¾ƒè¿ç®—ç¬¦çš„æŸ¥è¯¢
db.inventory.find( { "size.h": { $lt: 15 } } )

# å¸¦Andçš„æŸ¥è¯¢
db.inventory.find( { $and: [ { price: { $ne: 1.99 } }, { price: { $exists: true } } ] } )  # æ˜¾å¼å†™æ³•
db.inventory.find( { price: { $ne: 1.99, $exists: true } } )  # éšå¼å†™æ³•

# å¸¦Orçš„æŸ¥è¯¢
db.inventory.find( { $or: [ { status: "A" }, { qty: { $lt: 30 } } ] } )


# å¤æ‚æŸ¥è¯¢
# AND å’Œ OR ä¸€èµ·ä½¿ç”¨
db.inventory.find( {
    $and: [
        { $or: [ { qty: { $lt : 10 } }, { qty : { $gt: 50 } } ] },
        { $or: [ { sale: true }, { price : { $lt : 5 } } ] }
    ]
} )


db.inventory.find( {
     status: "A",
     $or: [ { qty: { $lt: 30 } }, { item: /^p/ } ]  // qtyå°äº30 æˆ– item ä»¥ p å¼€å¤´
} 

# è¾“å‡ºæ ¼å¼åŒ–
db.inventory.find({}).pretty()


```

### æ’å…¥æ–‡æ¡£

```
# use test
# å°†æ•°æ®æ’å…¥collectionsï¼šinventoryï¼Œæ­¤æ—¶ä¼šåˆ›å»ºtestæ•°æ®åº“
# æ’å…¥ä¸€æ¡æ•°æ®
db.inventory.insertOne(
   { "item" : "canvas",
     "qty" : 100,
     "tags" : ["cotton"],
     "size" : { "h" : 28, "w" : 35.5, "uom" : "cm" }
   }
)

# æ‰¹é‡æ’å…¥æ•°æ®
db.inventory.insertMany( [
   { "item": "journal", "qty": 25, "size": { "h": 14, "w": 21, "uom": "cm" }, "status": "A" },
   { "item": "notebook", "qty": 50, "size": { "h": 8.5, "w": 11, "uom": "in" }, "status": "A" },
   { "item": "paper", "qty": 100, "size": { "h": 8.5, "w": 11, "uom": "in" }, "status": "D" },
   { "item": "planner", "qty": 75, "size": { "h": 22.85, "w": 30, "uom": "cm" }, "status": "D" },
   { "item": "postcard", "qty": 45, "size": { "h": 10, "w": 15.25, "uom": "cm" }, "status": "A" }
]);
```

### æ›´æ–°æ–‡æ¡£

```
# æ›´æ–°
# æ›´æ–°ä¸€æ¡
db.inventory.updateOne(
    { "item" : "paper" }, // specifies the document to update
    {
      $set: {  "size.uom" : "cm",  "status" : "P" },
      $currentDate: { "lastModified": true }
    }
)

# æ›´æ–°å¤šæ¡
db.inventory.updateMany(
    { "qty" : { $lt: 50 } }, // specifies the documents to update
    {
       $set: { "size.uom" : "cm", "status": "P" },
       $currentDate : { "lastModified": true }
    }
)
```

### åˆ é™¤æ–‡æ¡£

```
# åˆ é™¤ä¸€æ¡
db.inventory.deleteOne(
    { "status": "D" } // specifies the document to delete
)
# åˆ é™¤å¤šæ¡
db.inventory.deleteMany(
    { "status" : "A" } // specifies the documents to delete
)
```



## è¡¥å……

- MongoDBä¸­å­˜åœ¨è®¸å¤šè¿ç®—ç¬¦ï¼Œå¦‚å‰ `$gt`ï¼Œ[Query and Projection Operators](https://docs.mongodb.com/manual/reference/operator/query/)

- é€šè¿‡ç¼–ç¨‹è¯­è¨€è¿æ¥ MongoDB æ–‡æ¡£ï¼šhttps://docs.mongodb.com/drivers/