(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{750:function(s,a,t){"use strict";t.r(a);var n=t(24),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("php 环境搭建是一件相当麻烦的事情，本篇博客记录了在Mac 系统下的环境配置。")]),s._v(" "),t("p",[s._v("Win上的php 环境搭建，建议使用XAMPP，一键搭建，而且自带xdebug.dll，用过就知道。Mac 上的php 环境，我一开始也使用了 XAMPP 作为环境，但是发现Mac 上的是阉割版的，也没有xdebug。")]),s._v(" "),t("p",[s._v("目前介绍的环境搭建方法是: "),t("strong",[s._v("brew")]),s._v(" 和 "),t("strong",[s._v("pecl")])]),s._v(" "),t("h2",{attrs:{id:"php-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-安装"}},[s._v("#")]),s._v(" PHP 安装")]),s._v(" "),t("h3",{attrs:{id:"安装过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装过程"}},[s._v("#")]),s._v(" 安装过程")]),s._v(" "),t("p",[s._v("Mac 上是自带php和Apache的")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("whereis")]),s._v(" php\n/usr/bin/php\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("我这里准备用brew 装一个最新的")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ brew search php\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Formulae\nbrew-php-switcher      php@7.2                phpmyadmin\nphp                    php@7.3 ✔              phpstan\nphp-code-sniffer       phplint                phpunit\nphp-cs-fixer           phpmd\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Casks\neclipse-php            netbeans-php           phpstorm\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("安装最新的 php 7.3")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ brew "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" php@7.3\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装后，我们需要添加环境变量")]),s._v("\nphp@7.3 is keg-only, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" means it was not symlinked into /usr/local,\nbecause this is an alternate version of another formula.\n\nIf you need to have php@7.3 first "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" your "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" run:\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'export PATH=\"/usr/local/opt/php@7.3/bin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.zshrc\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'export PATH=\"/usr/local/opt/php@7.3/sbin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.zshrc\n\nFor compilers to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" php@7.3 you may need to set:\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LDFLAGS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-L/usr/local/opt/php@7.3/lib"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CPPFLAGS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-I/usr/local/opt/php@7.3/include"')]),s._v("\n\nTo have launchd start php@7.3 now and restart at login:\n  brew services start php@7.3\nOr, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" you don't want/need a background "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" you can just run:\n  php-fpm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"brew-安装遇到的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#brew-安装遇到的问题"}},[s._v("#")]),s._v(" brew 安装遇到的问题")]),s._v(" "),t("p",[s._v("brew 安装php@7.3 的过程中，中间一条命令是 brew clean 产生了问题")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ brew cleanup\nWarning: Skipping opam: "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("most")]),s._v(" recent version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(".3 not installed\nWarning: Skipping python: "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("most")]),s._v(" recent version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(".2_2 not installed\nWarning: Skipping sqlite: "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("most")]),s._v(" recent version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.27")]),s._v(".1 not installed\nError: Permission denied @ unlink_internal - /usr/local/lib/node_modules/@angular/cli/node_modules/.bin/in-install\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("既然说我们权限不够，第一反应是使用 "),t("code",[s._v("sudo")]),s._v(" 命令，但是brew 不允许用户这么做。")]),s._v(" "),t("p",[s._v("经过查询后，可以使用如下命令，可以给没有权限的文件夹，更改权限。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(":admin /usr/local "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里文件夹填写需要的")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"安装-xdebug"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-xdebug"}},[s._v("#")]),s._v(" 安装 xdebug")]),s._v(" "),t("p",[s._v("xdebug 的安装是比较麻烦的，若是没有xdebug 需要的步骤复制很多。涉及到自己编译（自己编译的话，由于计算机环境不同又会产生很多问题）")]),s._v(" "),t("h3",{attrs:{id:"xampp-环境的安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xampp-环境的安装"}},[s._v("#")]),s._v(" XAMPP 环境的安装")]),s._v(" "),t("p",[s._v("这里XAMPP环境的话我建议参考下面的教程")]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/d60ad942aa88",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mac下XAMPP+PhpStorm中集成xdebug"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("简单的描述一下过程就是：")]),s._v(" "),t("p",[s._v("生成 phpinfo ，复制到 xdebug 官网"),t("a",{attrs:{href:"https://link.jianshu.com/?t=https://xdebug.org/wizard.php",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网下载xdebug.so"),t("OutboundLink")],1),s._v(" 下载xdebug.tgz")]),s._v(" "),t("p",[s._v("解压文件: "),t("code",[s._v("tar -xvzf xdebug.tgz")])]),s._v(" "),t("p",[s._v("编译过程官方教程(有坑)")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20191215000634.png",alt:""}})]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("blockquote",[t("p",[s._v("坑一：使用对phpize 命令。如果你电脑中安装的是XAMPP环境，你需要使用XAMPP环境的phpize")])]),s._v(" "),t("p",[t("code",[s._v("/Applications/XAMPP/xamppfiles/bin/phpize")])]),s._v(" "),t("blockquote",[t("p",[s._v("坑二：出现"),t("code",[s._v("Cannot find autoconf")]),s._v(" 错误")])]),s._v(" "),t("p",[t("code",[s._v("brew install autoconf")])]),s._v(" "),t("blockquote",[t("p",[s._v("坑三：./configure 编译问题")])]),s._v(" "),t("p",[t("code",[s._v("./configure --with-php-config=/Applications/XAMPP/xamppfiles/bin/php-config")])])]),s._v(" "),t("li",[t("p",[s._v("make 获得 xdebug.so 文件")])])]),s._v(" "),t("h3",{attrs:{id:"pecl-方法安装（采用的方法）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pecl-方法安装（采用的方法）"}},[s._v("#")]),s._v(" Pecl 方法安装（采用的方法）")]),s._v(" "),t("p",[s._v("我们使用的较为简单的方法，就是使用pecl命令，如果我们成功的安装了 php 的话，pecl 是自带的。pecl 相当于为我们省去了编译的过程，也帮我们避免了很多的坑")]),s._v(" "),t("p",[s._v("pecl 之于 php 相当于 pip 之于 python 和 npm 之于 node.js，管理的是 php 的扩展(或者叫插件？)")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20191215001759.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"配置php-ini"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置php-ini"}},[s._v("#")]),s._v(" 配置php.ini")]),s._v(" "),t("p",[s._v("找到php.ini 地址")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ php --ini\nConfiguration File "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("php.ini"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Path: /usr/local/etc/php/7.3\nLoaded Configuration File:         /usr/local/etc/php/7.3/php.ini\nScan "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" additional .ini files in: /usr/local/etc/php/7.3/conf.d\nAdditional .ini files parsed:      /usr/local/etc/php/7.3/conf.d/ext-opcache.ini\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("添加如下代码")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[xdebug]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("zend_extension")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/Applications/XAMPP/xamppfiles/lib/php/extensions/no-debug-non-zts-20160303/xdebug.so # xdebug 存放路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_autostart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("on")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_enable")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("on")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_mode")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('"req"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_host")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("localhost")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_port")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("9000 # 端口号，记住")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.remote_handler")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('"dbgp"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.idekey")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('"PhpStorm"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("xdebug.profiler_enable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" Off")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("查看xdebug 是否成功安装，使用 "),t("code",[s._v("php -m")]),s._v("  查看所有已安装的扩展，存在xdebug 则表明安装成功。当然也可以使用 "),t("code",[s._v("phpinfo()")]),s._v(" 查看xdebug。")]),s._v(" "),t("blockquote",[t("p",[s._v("注意: 重启Apache 服务才能看到 phpinfo 输出的情况")])]),s._v(" "),t("h2",{attrs:{id:"配置phpstorm-环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置phpstorm-环境"}},[s._v("#")]),s._v(" 配置phpstorm 环境")]),s._v(" "),t("p",[s._v("xdebug 在phpstorm 中的设置，有大量图，不想重复造轮子。看下面两个教程足够了。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/u012338816/article/details/52243785",target:"_blank",rel:"noopener noreferrer"}},[s._v("史上最佳 Mac+PhpStorm+XAMPP+Xdebug 集成开发和断点调试环境的配置"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/d60ad942aa88",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mac下XAMPP+PhpStorm中集成xdebug"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("实践下来，由于我只是作为php 后端开发，不需要与前端交互的话，我这里只需要保证下面的端口设置正确即可。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20191215013247.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"后记"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#后记"}},[s._v("#")]),s._v(" 后记")]),s._v(" "),t("p",[s._v("真实工作环境中，其实由于项目是很大的，实际上没有用到xdebug的机会（主要通过日志排查问题）。我这里安装xdebug 主要是想要通过逐步调试的过程，更好的理解php 语言，协程的使用方法等。")]),s._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://xdebug.org/docs/install#1",target:"_blank",rel:"noopener noreferrer"}},[s._v("xdebug 官方安装教程"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://stackoverflow.com/questions/54682876/brew-cleanup-error-permission-denied-unlink-internal",target:"_blank",rel:"noopener noreferrer"}},[s._v("brew cleanup 问题解决方法--stackoverflow"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);